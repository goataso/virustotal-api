# VirusTotal API v2.0

The VirusTotal API lets you upload and scan files or URLs, access finished scan reports and make automatic comments without the need of using the website interface. In other words, it allows you to build simple scripts to access the information generated by VirusTotal.

In order to use the API you must [sign up to VirusTotal Community](https://www.virustotal.com/#/join-us). Once you have a valid VirusTotal Community account you will find your personal API key in your personal settings section. This key is all you need to use the VirusTotal API.

## Important

The VirusTotal API must not be used in commercial products or services, it can not be used as a substitute for antivirus products and it can not be integrated in any project that may harm the antivirus industry directly or indirectly. Noncompliance of these terms will result in immediate permanent ban of the infractor individual or organization.

Under all circumstances VirusTotal's [Terms of Service](https://support.virustotal.com/hc/en-us/articles/115002145529-Terms-of-Service) and [Privacy Policy](https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy) must be respected.

By default any VirusTotal Community registered user is entitled to an API key that allows them to interact with a basic set of endpoints. Advanced research calls are available via the private API, which requires special privileges. [Contact us](https://support.virustotal.com/hc/en-us/requests/new) if you would like to learn more about how to obtain access.

Note that all endpoints referenced in this guide share a common URL prefix: www.virustotal.com/vtapi/v2/.

## Public vs Private API

While many of the endpoints and features provided by the VirusTotal API are freely accessible to all registered users, some of them are restricted to our premium customers only. Those endpoints and features constitute the VirusTotal Private API and they will be appropriately identified in this section. If you are interested in using our Private API please [contact us](https://support.virustotal.com/hc/en-us/requests/new).

* The Public API, on the other hand, is a set of endpoints available for everyone to use at no cost. The only thing you need in order to use the Public API is to sign up in VirusTotal Community and obtain your API key as described in Getting started.

## Notice

The Public API is limited to 4 requests per minute.
The Private API returns more threat data and exposes more endpoints.
The Private API is governed by an SLA that guarantees readiness of data.

The Private API has the following advantages over the Public API:

* Allows you to choose a request rate and daily quota allowance that best suits your needs.
* Will return further details about the resources scanned by VirusTotal, for instance: VBA code stream warnings for documents, source metadata, ExifTool output, IDS output for recorded network traces, etc.
* Includes metadata generated exclusively by VirusTotal: first submission date of a given file, list of file names with which a file was submitted to VirusTotal, submission countries, prevalence, etc.
* Will give you access to behavior information about files, produced by executing Windows PEs, DMGs, Mach-Os and APKs in a virtualized sandbox environment.
* Exposes whitelisting and [trusted source](http://blog.virustotal.com/2015/02/a-first-shot-at-false-positives.html) information.
* Allows you to perform property to sample queries: reverse searches such as give me all samples that are detected with the following signature, give me all samples that are detected by more than 10 engines, give me all samples that contain a given PE section with the following hash, etc. these search modifiers can be combined to build complex requests.
* Exposes file clustering and file similarity search calls.
* Enables you to download submitted samples for further research, along with the network traffic captures they generate upon execution and their detailed execution reports.
* Has a strict Service License Agreement (SLA) that guarantees availability and readiness of data.

## API responses

When interacting with the API, **if the request was correctly handled by the server and no errors were produced, a 200 HTTP status code will be returned**. The body of the response will usually be a JSON object (except for file downloads) that will contain at least the following two properties:


* response_code: if the item you searched for was not present in VirusTotal's dataset this result will be 0. If the requested item is still queued for analysis it will be -2. If the item was indeed present and it could be retrieved it will be 1. Any other case is detailed in the full reference.
* verbose_msg: provides verbose information regarding the response_code property.

| Code | Description                                                                    |
|------|--------------------------------------------------------------------------------|
| 204  | Request rate limit exceeded. You are making more requests than allowed.        |
| 400  | Bad request. Your request was somehow incorrect. This can be caused by missing |arguments or arguments with wrong values.
| 403  | Forbidden. You don't have enough privileges to make the request. You may be doing a request without providing an API key or you may be making a request to a Private API without having the appropriate privileges. |

## /file/report

Retrieve file scan reports

**GET** https://www.virustotal.com/vtapi/v2/file/report

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/file/report?apikey=<apikey>&resource=<resource>'
```

The `resource` argument can be the MD5, SHA-1 or SHA-256 of a file for which you want to retrieve the most recent antivirus report. You may also specify a `scan_id` returned by the [/file/scan](##/file/scan) endpoint.

If the `allinfo` argument is set to `true` additional information other than the antivirus results is returned. This additional information includes:

* the output of several third party tools acting on the file (PDFiD, ExifTool, sigcheck, TrID, etc.)
* the output of other in-house technologies.
* metadata regarding VirusTotal submissions:
  * number of unique sources that have sent the file in the past
  * `first_seen` first seen date
  * `submission_names` a list of file names it was sumitted as
* behaviour-v1 output of behavioral sandboxes if there was successful execution in the sandbox.

* File operations (read, write, open, etc)
* Network operations
* Mutex/registry operations

>**sandbox data**
>
>The [file/behaviour](##/file/behaviour) has the raw sandbox data, and requires additional parsing on the client > side. file/report with allinfo behaviour-v1 contains a good summary

>**Private API**
>
>The allinfo argument is available in the Private API only

Example response

```json
{
 'response_code': 1,
 'verbose_msg': 'Scan finished, scan information embedded in this object',
 'resource': '99017f6eebbac24f351415dd410d522d',
 'scan_id': '52d3df0ed60c46f336c131bf2ca454f73bafdc4b04dfa2aea80746f5ba9e6d1c-1273894724',
 'md5': '99017f6eebbac24f351415dd410d522d',
 'sha1': '4d1740485713a2ab3a4f5822a01f645fe8387f92',
 'sha256': '52d3df0ed60c46f336c131bf2ca454f73bafdc4b04dfa2aea80746f5ba9e6d1c',
 'scan_date': '2010-05-15 03:38:44',
 'permalink': 'https://www.virustotal.com/file/52d3df0ed60c46f336c131bf2ca454f73bafdc4b04dfa2aea80746f5ba9e6d1c/analysis/1273894724/',
 'positives': 40,
 'total': 40,
 'scans': {
   'nProtect': {
     'detected': true,
     'version': '2010-05-14.01',
     'result': 'Trojan.Generic.3611249',
     'update': '20100514'
   },
   'CAT-QuickHeal': {
     'detected': true,
     'version': '10.00',
     'result': 'Trojan.VB.acgy',
     'update': '20100514'
   },
   'McAfee': {
     'detected': true,
     'version': '5.400.0.1158',
     'result': 'Generic.dx!rkx',
     'update': '20100515'
   },
   'TheHacker': {
     'detected': true,
     'version': '6.5.2.0.280',
     'result': 'Trojan/VB.gen',
     'update': '20100514'
   },
   'VirusBuster': {
    'detected': true,
     'version': '5.0.27.0',
     'result': 'Trojan.VB.JFDE',
     'update': '20100514'
   }
 }
}
```

## /file/scan

Upload and scan a file

**POST** https://www.virustotal.com/vtapi/v2/file/scan

```shell
curl --request POST \ 
  --url 'https://www.virustotal.com/vtapi/v2/file/scan' \
  --form 'apikey=<apikey>' \
  --form 'file=@/path/to/file'
  
```

This endpoint allows you to send a file for scanning with VirusTotal. Before performing your submissions we encourage you to retrieve the latest report on the file, if it is recent enough you might want to save time and bandwidth by making use of it. File size limit is 32MB, in order to submit files up to 200MB in size you must request a special upload URL using the [/file/scan/upload_url](##/file/scan/upload_url) endpoint.

Example response

```json
{
 'permalink': 'https://www.virustotal.com/file/d140c...244ef892e5/analysis/1359112395/',
 'resource': 'd140c244ef892e59c7f68bd0c6f74bb711032563e2a12fa9dda5b760daecd556',
 'response_code': 1,
 'scan_id': 'd140c244ef892e59c7f68bd0c6f74bb711032563e2a12fa9dda5b760daecd556-1359112395',
 'verbose_msg': 'Scan request successfully queued, come back later for the report',
 'sha256': 'd140c244ef892e59c7f68bd0c6f74bb711032563e2a12fa9dda5b760daecd556'
}
```

## /file/scan/upload_url

Get a URL for uploading files larger than 32MB

**GET** https://www.virustotal.com/vtapi/v2/file/scan/upload_url

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/file/scan/upload_url?apikey=<apikey>'
```

>**Restricted API**
>
>This API requires additional privileges. Please contact us if you need to upload files >bigger than 32MB in size.

In order to submit files bigger than 32MB you need to obtain a special upload URL to which you can POST files up to 200MB in size. This API generates such a URL.

Example response

```json
{
  'upload_url': 'https://www.virustotal.com/_ah/upload/?apikey=>apikey</AMmfu6aOazgAdakralarFKHjJvxHdDiN5umGU9j5RzEfWPU8jQwtRgAM_LkxJlR24R0SCJ7MsIkWLD-C9nSraPSBwK7ujv84k3QNhzkSwX-GqcerFjSOZS25eHTQP6QBDyCXWAU4vEzIHcX1iigpcTbLrS9O9LnXQUs3Jn_kocDc61aDki2-Cm6ARN99JbAK82H8lWG3cBN1c4_WJbaeCDTNNnkky8Bfz8Qhxf327o_6GPAWVeeIt39TYTYL1e45-zwxFrqFHIWl/ALBNUaYAAAAAUQKBI1y6AfbKZLSO5QBdb2zDB0EYysh6/'
}
```

## /file/rescan

Re-scan a file

**POST** https://www.virustotal.com/vtapi/v2/file/rescan

```shell
curl --request POST \
  --url 'https://www.virustotal.com/vtapi/v2/file/rescan' \
  --data 'apikey=<apikey>' \
  --data 'resource=<resource>'
```

>**Caution**
>
>This API has the potential to produce a denial of service on the scanning infrastructure if >abused. Please contact us if you are going to be rescanning more than 50K files per day.

The `resource` argument can be the MD5, SHA-1 or SHA-256 of the file you want to re-scan

Example response

```json
{
  'response_code': 1,
  'scan_id': '54bc950d46a0d1aa72048a17c8275743209e6c17bdacfc4cb9601c9ce3ec9a71-1390472785',
  'permalink': 'https://www.virustotal.com/file/__sha256hash__/analysis/1390472785/',
  'sha256': '54bc950d46a0d1aa72048a17c8275743209e6c17bdacfc4cb9601c9ce3ec9a71',
  'resource': '7657fcb7d772448a6d8504e4b20168b8'
}
```

## /file/download

Download a file

**GET** https://www.virustotal.com/vtapi/v2/file/download

```shell
curl -v --location --output sample.bin \
  --url 'https://www.virustotal.com/vtapi/v2/file/download?apikey=<apikey>&hash=<hash>'
```

>**Private API**
>
>This endpoint is available in the Private API only.

## /file/behaviour

Retrieve behaviour report

**GET** https://www.virustotal.com/vtapi/v2/file/behaviour

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/file/behaviour?apikey=<apikey>&hash=<hash>'
```

>**Private API**
>
>This endpoint is available in the [Private API](https://developers.virustotal.com/v2.0/docs/public-vs-private-api) only.

VirusTotal runs a distributed setup of [Cuckoo sandbox](http://www.cuckoosandbox.org/) machines that execute the files we receive. Execution is attempted only once, upon first submission to VirusTotal, and only Portable Executables under 10MB in size are ran. The execution of files is a best effort process, hence, there are no guarantees about a report being generated for a given file in our dataset.

If a file did indeed produce a behavioral report, a summary of it can be obtained by using the [/file/report](##/file/report) endpoint providing the additional parameter `allinfo=true`. The summary will appear under the `behaviour-v1` property of the `additional_info` field in the JSON report.

This API allows you to retrieve the full JSON report of the file's execution as returned by the Cuckoo JSON report encoder.

## /file/network-traffic

Retrieve network traffic report

**GET** https://www.virustotal.com/vtapi/v2/file/network-traffic

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/file/network-traffic?apikey=<apikey>&hash=<hash>
```

>**Private API**
>
>This endpoint is available in the [Private API](https://developers.virustotal.com/v2.0/docs/public-vs-private-api) only.

## /file/feed

Retrieve live feed of all files submitted to VirusTotal

**GET** https://www.virustotal.com/vtapi/v2/file/feed

```shell
curl --location --output package.tar.bz2 --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/file/feed?apikey=<apikey>&package=<package>'
```

>**Private API**
>
>This endpoint is available in the [Private API](https://developers.virustotal.com/v2.0/docs/public-vs-private-api) only.

This endpoint allows you to retrieve a live feed of absolutely all uploaded files to VirusTotal, and download them for further scrutiny, along with their full reports. It requires you to stay relatively synced with the live submissions as only a backlog of 24 hours is provided at any given point in time.

The `package` argument indicates a time window to pull reports on all items received during such window. Only per-minute and hourly windows are allowed, the format is %Y%m%dT%H%M (e.g. `20160304T0900`) or %Y%m%dT%H (e.g. `20160304T09`). Time is expressed in UTC.

The response is a bzip2 compressed tarball. For per-minute packages the compressed package contains a unique file, the file contains a JSON per line, this JSON is a full report on a given file processed by VirusTotal during the given time window. The file report follows the exact same format as the response of the [/file/report](##/file/report) endpoint when `allinfo=true` is provided. For hourly packages, the tarball contains 60 files, one per each one-minute window.

To download a given file you would then perform an HTTP GET request to the URL provided in the link property of an individual report. Do not use the [/file/download](##/file/download) endpoint to retrieve the corresponding file, please use the link embedded in this response, it is far more efficient.

## /file/clusters

Retrieve file clusters

**GET** https://www.virustotal.com/vtapi/v2/file/clusters

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/file/clusters?apikey=<apikey>&date=<date>'
```

>**Private API**
>
>This endpoint is available in the [Private API](https://developers.virustotal.com/v2.0/docs/public-vs-private-api) only.

VirusTotal has built its own in-house file similarity clustering functionality. At present, this clustering works only on PE, PDF, DOC and RTF files and is based on a very simple structural feature hash. This hash can very often be confused by certain compression and packing strategies, in other words, this clustering logic is no holly grail, yet it has proven itself very useful in the past.

All of the API responses are JSON objects, if no clusters were identified for the given time frame, this JSON will have a response_code property equal to 0, if there was some sort of error with your query this code will be set to -1, if your query succeeded and file similarity clusters were found it will have a value of 1 and the rest of the JSON properties will contain the clustering information.

Example response

```json
{
 'response_code': 1,
 'verbose_msg': 'Clustering information enclosed',
 'num_candidates': 184701,
 'num_clusters': 44269,
 'size_top200': 85160,
 'clusters': [
  {
   'label': 'vilsel [0001]',
   'avg_positives': 43, 
   'id': 'vhash 0740361d051)z1e3z 2013-09-10', 
   'size': 5712
  },
  {
    'label': 'installer [0032]',
    'avg_positives': 7, 
    'id': 'vhash 02503e0f7d5019z6hz13z1fz 2013-09-10', 
    'size': 4710
  },
  {
    'label': 'megasearch [0000]', 
    'avg_positives': 12, 
    'id': 'vhash 075056651d1d155az639z25z12z14fz 2013-09-10', 
    'size': 3651
  }
 ]
}
```

The JSON object returned by this endpoint contains several properties, some of them may not be clear, the following table provides some further insight:

**`num_candidates`** Total number of files submitted during the given time frame for which a feature hash could be calculated.

**`num_clusters`** Total number of clusters generated for the given time period under consideration, a cluster can be as small as an individual file, meaning that no other feature-wise similar file was found.

**`size_top200`** The sum of the number of files in the 200 largest clusters identified.

**`clusters List`** of JSON objects that contain details about the 200 largest clusters identified. These objects contain 4 properties: id, label, size and avg_positives.. The id field can be used to then query the search API call for files contained in the given cluster. The label property is a verbose human-intelligible name for the cluster. The size field is the number of files that make up the cluster. Finally, avg_positives represents the average number of antivirus detections that the files in the cluster exhibit.

## /file/search

Search for files

**GET** https://www.virustotal.com/vtapi/v2/file/search

```shell
curl --request GET 
  --url 'https://www.virustotal.com/vtapi/v2/file/search?apikey=<apikey>&query=<query>'
```

>**Private API**
>
>This endpoint is available in the [Private API](https://developers.virustotal.com/v2.0/docs/public-vs-private-api) only.

In addition to retrieving information on a particular file, VirusTotal allows you search for files matching certain properties. For example, this functionality enables you to retrieve all those files marked by at least one antivirus vendor as Zbot, or all those files that have a size under 90KB and are detected by at least 10 antivirus solutions, or all those PDF files that have an invalid XREF section, etc.

This API is equivalent to VirusTotal Intelligence advanced searches. A very wide variety of search modifiers are available, including: file size, file type, first submission date to VirusTotal, last submission date to VirusTotal, number of positives, dynamic behavioural properties, binary content, submission file name, and a very long etcetera. The full list of search modifiers allowed for file search queries is documented at https://www.virustotal.com/intelligence/help/file-search/#search-modifiers.

On each request you will get at most 300 files matching the query. You can get the next 300 files by passing the `offset` received in the previous query as an argument to the next query. In those cases the `query` argument most be identical to the one passed to the previous request.

The returned files are sorted according to their submission date, in descending order.

Example response

```json
{
 'response_code': 1,
 'offset': 'RmFsc2U6Q3ZrRkN1b0RDc1lEX...KdWVtcHpJeHA3TXk4M0h6OHpMbmN2X0FBRF',
 'hashes': [
   'c9bfeaf31115dccfe033f67c3b56453a5e434e2e39a2dcf76d80c05603ef9cda',
   '510c0c513b10ebec6ed5d577d8e4701950beb61bbc48f99a61c4780ba58e5fb9',
   '32aef41d79c9bca51c1aa63d1625abc721d2518e133b8667bcca9c4f0c4a60a6'
 ]
}
```

## /url/report

Retrieve URL scan reports

**GET** https://www.virustotal.com/vtapi/v2/url/report

```shell
curl --request GET \
    --url 'https://www.virustotal.com/vtapi/v2/url/report?apikey=<apikey>&resource=<resource>'
```

The `resource` argument must be the URL for which you want to retrieve the most recent report. You may also specify a `scan_id` returned by the [/url/scan](##/url/scan) endpoint to access a specific report.

If the `allinfo` argument is set to `true` additional information other than the URL scanning engines results is returned. VirusTotal related metadata (first seen date, last seen date, files downloaded from the given URL, etc.) and the output of other tools and datasets when fed with the URL.

Example response

```json
{
 'response_code': 1,
 'verbose_msg': 'Scan finished, scan information embedded in this object',
 'scan_id': '1db0ad7dbcec0676710ea0eaacd35d5e471d3e11944d53bcbd31f0cbd11bce31-1390467782',
 'permalink': 'https://www.virustotal.com/url/__urlsha256__/analysis/1390467782/',
 'url': 'http://www.virustotal.com/',
 'scan_date': '2014-01-23 09:03:02',
 'filescan_id': null,
 'positives': 0,
 'total': 51,
 'scans': {
    'CLEAN MX': {
      'detected': false, 
      'result': 'clean site'
    },
    'MalwarePatrol': {
      'detected': false, 
      'result': 'clean site'
    }
  }
}
```

## /url/scan

Scan an URL

**POST** https://www.virustotal.com/vtapi/v2/url/scan

```shell
curl --request POST \
  --url 'https://www.virustotal.com/vtapi/v2/url/scan' \
  --data 'apikey=<apikey>' \
  --data 'url=<url>'
```

Example response

```json
{
 'response_code': 1,
 'verbose_msg': 'Scan request successfully queued, come back later for the report',
 'scan_id': '1db0ad7dbcec0676710ea0eaacd35d5e471d3e11944d53bcbd31f0cbd11bce31-1320752364',
 'scan_date': '2011-11-08 11:39:24',
 'url': 'http://www.virustotal.com/',
 'permalink': 'http://www.virustotal.com/url/1db0ad7dbcec0676710ea0eaacd35d5e471d3e11944d53bcbd31f0cbd11bce31/analysis/1320752364/'
}

```

## /url/feed

Retrieve live feed of all URLs submitted to VirusTotal

**GET** https://www.virustotal.com/vtapi/v2/url/feed

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/url/feed?apikey=apikey&package=package'
```

>**Private API**
>
>This endpoint is available in the [Private API](https://developers.virustotal.com/v2.0/docs/public-vs-private-api) only.

This endpoint allows you to retrieve a live feed of reports on absolutely all URLs scanned by VirusTotal. It requires you to stay relatively synced with the live submissions as only a backlog of 24 hours is provided at any given point in time.

The `package` argument indicates a time window to pull reports on all items received during such window. Only per-minute and hourly windows are allowed, the format is %Y%m%dT%H%M (e.g. `20160304T0900`) or %Y%m%dT%H (e.g. `20160304T09`). Time is expressed in UTC.

The response is a bzip2 compressed tarball. For per-minute packages the compressed package contains a unique file, the file contains a JSON per line, this JSON is a full report on a given URL processed by VirusTotal during the given time window. The URL report follows the exact same format as the response of the [/url/report](##/url/report) endpoint when `allinfo=true` is provided. For hourly packages, the tarball contains 60 files, one per each one-minute window.

## /domain/report

Retrieves a domain report

**GET** https://www.virustotal.com/vtapi/v2/domain/report

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/domain/report?apikey=<apikey>&domain=<domain>'
```

Example response

```json
{
  "undetected_referrer_samples": [{
    "date": "2018-03-04 16:38:06",
    "positives": 0,
    "total": 66,
    "sha256": "ce08cf22949b6b6fcd4e61854ce810a4f9ee04529340dd077fa354d759dc7a95"
  }, {
    "positives": 0,
    "total": 53,
    "sha256": "b8f5db667431d02291eeec61cf9f0c3d7af00798d0c2d676fde0efb0cedb7741"
  }],
  "whois_timestamp": 1520586501,
  "detected_downloaded_samples": [{
    "date": "2013-06-20 18:51:30",
    "positives": 2,
    "total": 46,
    "sha256": "cd8553d9b24574467f381d13c7e0e1eb1e58d677b9484bd05b9c690377813e54"
  }],
  "detected_referrer_samples": [],
  "undetected_downloaded_samples": [{
    "date": "2018-01-14 22:34:24",
    "positives": 0,
    "total": 70,
    "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  }],
  "resolutions": [{
    "last_resolved": "2018-03-09 00:00:00",
    "ip_address": "185.53.177.31"
  }, {
    "last_resolved": "2013-06-20 00:00:00",
    "ip_address": "90.156.201.97"
  }],
  "subdomains": [
    "test.027.ru",
    "www.027.ru"
  ],
  "categories": [
    "parked",
    "uncategorized"
  ],
  "domain_siblings": [],
  "undetected_urls": [],
  "response_code": 1,
  "verbose_msg": "Domain found in dataset",
  "detected_urls": [{
    "url": "http://027.ru/",
    "positives": 2,
    "total": 67,
    "scan_date": "2018-04-01 15:51:22"
  }, {
    "url": "http://027.ru/adobe/flash_install_v10x1.php",
    "positives": 5,
    "total": 67,
    "scan_date": "2018-03-26 09:22:43"
  }, {
    "url": "http://027.ru/track.php",
    "positives": 4,
    "total": 66,
    "scan_date": "2018-01-14 22:39:41"
  }, {
    "url": "http://027.ru/track.php?domain=027.ru&caf=1&toggle=answercheck",
    "positives": 2,
    "total": 66,
    "scan_date": "2018-01-09 22:19:43"
  }, {
    "url": "https://027.ru/",
    "positives": 1,
    "total": 66,
    "scan_date": "2016-02-08 13:25:40"
  }],
}
```

## /ip-address/report

Retrieve an IP address report

**GET** https://www.virustotal.com/vtapi/v2/ip-address/report

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/ip-address/report?apikey=<apikey>&ip=<ip>'
```

Example response

```json
{
  'response_code': 1,
  'verbose_msg': 'IP address found in dataset',
  'asn': '25532',
  'country': 'RU',
  'resolutions': [{
    'last_resolved': '2013-04-08 00:00:00',
    'hostname': '027.ru'
  }, {
    'last_resolved': '2013-04-08 00:00:00',
    'hostname': 'auto.rema-tiptop.ru'
  }, {
    'last_resolved': '2013-04-08 00:00:00',
    'hostname': 'catalog24de.ru'
  }, {
    'last_resolved': '2013-04-08 00:00:00',
    'hostname': 'club.velhod.ru'
  }, {
    'last_resolved': '2013-04-08 00:00:00',
    'hostname': 'danilova.pro'
  }],
  'detected_urls': [{
    'url': 'http://027.ru/',
    'positives': 2,
    'total': 37,
    'scan_date': '2013-04-07 07:18:09'
  }],
  'detected_downloaded_samples': [{
    'date': '2018-03-29 18:38:05',
    'positives': 2,
    'total': 59,
    'sha256': 'd9cacb75a3fd126762f348d00fb6e3809ede2c13b2ad251831e130bcb7ae7a84'
  }, {
    'date': '2018-03-29 08:52:38',
    'positives': 2,
    'total': 59,
    'sha256': '416751ebbd5d6c37bb20233a39ade80db584057f3d5c4bbf976ce9c332836707'
  }],
  'undetected_downloaded_samples': [{
    'date': '2018-03-28 06:36:55',
    'positives': 0,
    'total': 0,
    'sha256': '4a91398fd21f2d0b09fc7478d016d4a8fc9fe6f1c01e10b8e7c725542260cd9f'
  }, ],
  'undetected_urls': [
    [
      'http://zadiplomom.ru/',
      '3aafd5a54bb034882b8f5544bb647b6841bcb6ce938c40fb92be4cb84f2f0983',
      0,
      67,
      '2018-02-19 18:04:15'
    ],
  }
}
```

Response fields.


| Response key | Description |
|--------------|-------------|
| asn | Autonomous system number |  
| country | Our guess on what country it is in
|  resolutions | Hostnames that this IP address resolves to and the date
| detected_urls | URLs at this IP address that have at least 1 detection on a URL scan
| detected_downloaded_samples | Files that have been downloaded from this IP address with at least one AV detection
| undetected_downloaded_samples | Files that have been downloaded from this IP address with zero AV detections
| undetected_urls | URLs at this IP address with no detections on a URL scan.

## /comments/get

Get comments for a file or URL

**GET** https://www.virustotal.com/vtapi/v2/comments/get

```shell
curl --request GET \
  --url 'https://www.virustotal.com/vtapi/v2/comments/get?apikey=apikey&resource=resource'
```

Example response

```json
{
 'response_code': 1,
 'verbose_msg': 'Resource found, comments, if any, returned here',
 'resource': '13166fc9de263ee2c676430ae88e65040e10761c90e79347a2684476bc60e622',
 'comments': [
   {
    'date': '20120404132340',
    'comment': '[b]Bot Communication Details:[\/b]\nServer DNS Name: 67.230.163.30
                   Service Port: 80\nDirection Command User-Agent Host Connection
                   Pragma\nGET \/?0b72ab=huTK4N7k6G9718ze0NLa5%2BnM1NaHx9fXtqfeyr
                   FjiKSbxZ%2BmmqOjpqeXZqPPnpOhnda\nrpJ2bkpfLyZdk0MqokZNplofO5aKh
                   [... continues ...]'
   },
   {
    'date': '20120404132122',
    'comment': '#fakeAV'
   },
   {
    'date': '20120404131639',
    'comment': 'GET \/ury1007_8085.php?il41225lo=jeWqkqWocs3h1NDHi6Lcx56mlaqol
                   tnVmG5lWJbO0eWeuqZ6w4nN4aKjo6CgkqOkb6mrxL%2BZw8%2FJatXCqrOdmO3
                   S16mjl5eUnNbemcTJooLGicreoqOpp5eeZ2pgY26aoaOUjNih1NfW4aKjmefS0
                   HFiYmRrkuPnzaPGXtSYx6KepaWkopKopG9jaJ%2BiqJWamWWjicXd0tPc3qbjq
                   6hlYKXR4ebQ1MaZoNDC4dnX5eLUmpiVoKVj1d3Z0IzPpNnXnuPb6d%2Fm0ZKnp
                   pR1otCs5sbUyXPcz8aS HTTP\/1.1\nAccept: image\/gif, image\/jpeg
                   , image\/pjpeg, image\/pjpeg, application\/x-shockwave-flash,
                   application\/vnd.ms-excel, application\/vnd.ms-powerpoint,
                   [... continues ...]'
   }
  ]
}
```

The server answers with the comments sorted in descending order according to their date. Please note that it will only answer back with at most 25 comments. If the answer contains less than 25 comments it means that there are no more comments for that item. On the other hand, if 25 comments were returned you can keep issuing further calls making use of the optional `before` parameter, this parameter should be fixed to the oldest (last in the list) comment's date token, exactly in the same format that was returned by your previous API call (e.g. 20120404132340).

If there were any comments the response code will be 1, and 0 if otherwise. Please note that comments may have [bbcode](https://en.wikipedia.org/wiki/BBCode) formatting tags in them.

## /comments/put

Post comment for a file or URL

**POST** https://www.virustotal.com/vtapi/v2/comments/put

```shell
curl -v --request POST \
  --url 'https://www.virustotal.com/vtapi/v2/comments/put' \
  -d apikey=${VT_API_KEY} \
  -d 'comment=#malware' \
  -d resource=8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93
```

>**Tag the comments**
>
>See the [community documentation](https://support.virustotal.com/hc/en-us/articles/115002146769-Vote-comment) on using hash tags.
